<!DOCTYPE html>
<!-- saved from url=(0076)https://toiletmirror.azurewebsites.net/BsPages/MirrorPages/peopleiframe.aspx -->
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><title>

</title><meta http-equiv="X-UA-Compatible" content="IE=edge">
    <script src="./jquery.min.js.下載"></script>
    <link href="./bootstrap.min.css" rel="stylesheet">
    <script src="./bootstrap.min.js.下載"></script>
    <script src="./tstiAjax.js.下載"></script>
    
    <link rel="stylesheet" href="./normal.css">

    <style>
        body {
            user-select: none;
            touch-action: none;
            background: #ffffff;
        }

        p, span {
            z-index: 2;
            display: flex;
            align-items: flex-end;
        }
    </style>
</head>
<body style="background: #219298">
    <div class="d-flex flex-column vh-100 position-relative">
        <div id="PeopleDataPlace" class="ver-blcok-num2">
        
    <div class="man">
        <div class=" bg-white people-outside">
            <div class="value-outside" data-seq="2">
                <div>
                    <div class="d-flex align-items-center">
                        <div>
                            <svg viewBox="0 0 59.871094 51.097656" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:svg="http://www.w3.org/2000/svg" class="man-svg">
                              <path d="m 17.736328,0 c -3.50481,0 -5.472156,1.1260606 -6.878906,2.0566406 -3.8141502,2.52309 -5.1845233,6.400985 -4.0019533,10.2343754 1.3546701,4.39127 4.0070463,4.599623 5.5722663,7.371093 1.76042,3.1171 -0.07991,4.684968 -2.5273442,6.710938 C 6.3383106,29.321687 4.2698849,32.717839 2.4218749,37.230469 1.1156023,40.420248 0.35035545,43.79417 0,45.546875 a 53.936939,32.512138 0 0 0 4.9062499,1.771484 c 0.3140706,-1.149844 0.91611,-3.307375 1.5664063,-5.095703 1.1423,-3.14135 2.5703126,-5.855468 2.5703126,-5.855468 0,0 -1.2309291,7.676996 -0.328125,12.083984 a 53.936939,32.512138 0 0 0 2.2910162,0.521484 c 0.449405,-1.806431 1.090687,-4.018219 1.972656,-6.171875 1.91279,-4.67083 4.202104,-8.453125 8.052734,-11.640625 1.21834,-1.00854 2.08467,-1.837934 2.34961,-2.339844 0.26496,-0.501889 0.37566,-0.674116 -0.28711,-1.847656 -0.55533,-0.9833 -1.333645,-1.536587 -2.478515,-2.591797 -1.14488,-1.05521 -2.480602,-2.635448 -3.263672,-5.173828 -1.42275,-4.61194 0.391744,-9.5684541 4.808594,-12.4902341 1.10937,-0.73385 2.788624,-1.6825294 5.171874,-2.1308594 C 26.637242,3.6504175 25.731645,2.7951506 24.615235,2.0566406 23.208475,1.1260706 21.241138,0 17.736328,0 Z m 24.400391,0 c -3.5048,0 -5.474109,1.1260606 -6.880859,2.0566406 -1.09118,0.72183 -1.979509,1.5540638 -2.667969,2.4648438 2.57748,0.41533 4.371879,1.4225594 5.537109,2.1933594 4.41684,2.92177 6.231354,7.8802272 4.808594,12.4921872 -0.78307,2.53838 -2.116839,4.118618 -3.261719,5.173828 -1.14488,1.05521 -1.923185,1.608497 -2.478515,2.591797 -0.66277,1.17354 -0.55205,1.345756 -0.28711,1.847656 0.26495,0.5019 1.13128,1.329361 2.34961,2.337891 3.85064,3.1875 6.139944,6.971738 8.052734,11.642578 0.869368,2.122908 1.503006,4.299441 1.951172,6.091797 a 53.936939,32.512138 0 0 0 1.898437,-0.443359 c 0.902805,-4.406995 -0.330078,-12.082031 -0.330078,-12.082031 0,0 1.428003,2.712165 2.570313,5.853515 0.650288,1.788328 1.254289,3.947812 1.568359,5.097656 a 53.936939,32.512138 0 0 0 4.904297,-1.771484 c -0.350386,-1.752793 -1.115679,-5.126796 -2.421875,-8.316406 -1.848,-4.51263 -3.914472,-7.910725 -7.476562,-10.859375 -2.44745,-2.02597 -4.289717,-3.593838 -2.529297,-6.710938 1.56521,-2.77147 4.217605,-2.979834 5.572265,-7.371094 1.18257,-3.8333995 -0.18585,-7.7093314 -4,-10.2324214 C 47.608865,1.1260706 45.641529,0 42.136719,0 Z M 29.935547,6.328125 c -3.5048,0 -5.472156,1.1260606 -6.878906,2.0566406 -3.81415,2.5230904 -5.18257,6.4009854 -4,10.2343754 1.35467,4.39127 4.005092,4.599623 5.570312,7.371093 1.76042,3.1171 -0.07991,4.684968 -2.527343,6.710938 -3.56209,2.94864 -5.628563,6.344792 -7.476563,10.857422 -0.814335,1.98851 -1.416316,4.058764 -1.847656,5.777344 a 53.936939,32.512138 0 0 0 5.332031,0.910156 c 0.187869,-0.593243 0.378837,-1.184865 0.564453,-1.695313 1.1423,-3.14135 2.570313,-5.855469 2.570313,-5.855469 0,0 -0.622742,3.976121 -0.644531,7.84961 a 53.936939,32.512138 0 0 0 9.33789,0.552734 53.936939,32.512138 0 0 0 9.339844,-0.552734 c -0.02168,-3.873839 -0.646484,-7.84961 -0.646484,-7.84961 0,0 1.428012,2.712166 2.570312,5.853516 0.185652,0.51054 0.378505,1.10391 0.566406,1.697266 a 53.936939,32.512138 0 0 0 5.332032,-0.91211 C 46.66634,47.61575 46.064042,45.546396 45.25,43.558594 c -1.848,-4.51263 -3.914472,-7.910725 -7.476562,-10.859375 -2.44745,-2.02597 -4.289717,-3.593838 -2.529297,-6.710938 1.56521,-2.77146 4.217605,-2.979834 5.572266,-7.371093 1.182579,-3.8334 -0.187804,-7.709322 -4.001954,-10.2324224 -1.40676,-0.93057 -3.374096,-2.0566406 -6.878906,-2.0566406 z"></path>
                            </svg>
                        </div>
                        <div class="d-flex people-count">
                            <span class="nowval">1</span>
                            <span class="maxval"> /8</span>
                        </div>
                    </div>
                    <div class="w-100 position-relative">
                        <div class="place-value-outside">
                            <div class="people-status d-flex align-items-center">
                                <span>人少</span>
                                <div class="w-100 d-flex align-items-center flex-column position-relative">
                                    <p class="people-rangebar">
                                        <span></span>
                                        <span></span>
                                        <span></span>
                                    </p>
                                    <p class="triangle low"></p>
                                </div>
                                <span>人多</span>
                            </div>
                            <label class="sparse" style="display:none;">2</label>
                            <label class="crowded" style="display:none;">5</label>
                        </div>
                    </div>

                </div>
            </div>
            <div class="placename-outside">
                <div class="d-flex">
                    <img src="./map.svg" alt="map" class="map-icon">
                    <img src="./hand-point.svg" alt="map" class="map-icon blink">
                </div>
                <h5 class="placename">一樓東側 男廁</h5>
            </div>
        </div>
    </div>

    <div class="man">
        <div class=" bg-white people-outside">
            <div class="value-outside" data-seq="3">
                <div>
                    <div class="d-flex align-items-center">
                        <div>
                            <svg viewBox="0 0 59.871094 51.097656" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:svg="http://www.w3.org/2000/svg" class="man-svg">
                              <path d="m 17.736328,0 c -3.50481,0 -5.472156,1.1260606 -6.878906,2.0566406 -3.8141502,2.52309 -5.1845233,6.400985 -4.0019533,10.2343754 1.3546701,4.39127 4.0070463,4.599623 5.5722663,7.371093 1.76042,3.1171 -0.07991,4.684968 -2.5273442,6.710938 C 6.3383106,29.321687 4.2698849,32.717839 2.4218749,37.230469 1.1156023,40.420248 0.35035545,43.79417 0,45.546875 a 53.936939,32.512138 0 0 0 4.9062499,1.771484 c 0.3140706,-1.149844 0.91611,-3.307375 1.5664063,-5.095703 1.1423,-3.14135 2.5703126,-5.855468 2.5703126,-5.855468 0,0 -1.2309291,7.676996 -0.328125,12.083984 a 53.936939,32.512138 0 0 0 2.2910162,0.521484 c 0.449405,-1.806431 1.090687,-4.018219 1.972656,-6.171875 1.91279,-4.67083 4.202104,-8.453125 8.052734,-11.640625 1.21834,-1.00854 2.08467,-1.837934 2.34961,-2.339844 0.26496,-0.501889 0.37566,-0.674116 -0.28711,-1.847656 -0.55533,-0.9833 -1.333645,-1.536587 -2.478515,-2.591797 -1.14488,-1.05521 -2.480602,-2.635448 -3.263672,-5.173828 -1.42275,-4.61194 0.391744,-9.5684541 4.808594,-12.4902341 1.10937,-0.73385 2.788624,-1.6825294 5.171874,-2.1308594 C 26.637242,3.6504175 25.731645,2.7951506 24.615235,2.0566406 23.208475,1.1260706 21.241138,0 17.736328,0 Z m 24.400391,0 c -3.5048,0 -5.474109,1.1260606 -6.880859,2.0566406 -1.09118,0.72183 -1.979509,1.5540638 -2.667969,2.4648438 2.57748,0.41533 4.371879,1.4225594 5.537109,2.1933594 4.41684,2.92177 6.231354,7.8802272 4.808594,12.4921872 -0.78307,2.53838 -2.116839,4.118618 -3.261719,5.173828 -1.14488,1.05521 -1.923185,1.608497 -2.478515,2.591797 -0.66277,1.17354 -0.55205,1.345756 -0.28711,1.847656 0.26495,0.5019 1.13128,1.329361 2.34961,2.337891 3.85064,3.1875 6.139944,6.971738 8.052734,11.642578 0.869368,2.122908 1.503006,4.299441 1.951172,6.091797 a 53.936939,32.512138 0 0 0 1.898437,-0.443359 c 0.902805,-4.406995 -0.330078,-12.082031 -0.330078,-12.082031 0,0 1.428003,2.712165 2.570313,5.853515 0.650288,1.788328 1.254289,3.947812 1.568359,5.097656 a 53.936939,32.512138 0 0 0 4.904297,-1.771484 c -0.350386,-1.752793 -1.115679,-5.126796 -2.421875,-8.316406 -1.848,-4.51263 -3.914472,-7.910725 -7.476562,-10.859375 -2.44745,-2.02597 -4.289717,-3.593838 -2.529297,-6.710938 1.56521,-2.77147 4.217605,-2.979834 5.572265,-7.371094 1.18257,-3.8333995 -0.18585,-7.7093314 -4,-10.2324214 C 47.608865,1.1260706 45.641529,0 42.136719,0 Z M 29.935547,6.328125 c -3.5048,0 -5.472156,1.1260606 -6.878906,2.0566406 -3.81415,2.5230904 -5.18257,6.4009854 -4,10.2343754 1.35467,4.39127 4.005092,4.599623 5.570312,7.371093 1.76042,3.1171 -0.07991,4.684968 -2.527343,6.710938 -3.56209,2.94864 -5.628563,6.344792 -7.476563,10.857422 -0.814335,1.98851 -1.416316,4.058764 -1.847656,5.777344 a 53.936939,32.512138 0 0 0 5.332031,0.910156 c 0.187869,-0.593243 0.378837,-1.184865 0.564453,-1.695313 1.1423,-3.14135 2.570313,-5.855469 2.570313,-5.855469 0,0 -0.622742,3.976121 -0.644531,7.84961 a 53.936939,32.512138 0 0 0 9.33789,0.552734 53.936939,32.512138 0 0 0 9.339844,-0.552734 c -0.02168,-3.873839 -0.646484,-7.84961 -0.646484,-7.84961 0,0 1.428012,2.712166 2.570312,5.853516 0.185652,0.51054 0.378505,1.10391 0.566406,1.697266 a 53.936939,32.512138 0 0 0 5.332032,-0.91211 C 46.66634,47.61575 46.064042,45.546396 45.25,43.558594 c -1.848,-4.51263 -3.914472,-7.910725 -7.476562,-10.859375 -2.44745,-2.02597 -4.289717,-3.593838 -2.529297,-6.710938 1.56521,-2.77146 4.217605,-2.979834 5.572266,-7.371093 1.182579,-3.8334 -0.187804,-7.709322 -4.001954,-10.2324224 -1.40676,-0.93057 -3.374096,-2.0566406 -6.878906,-2.0566406 z"></path>
                            </svg>
                        </div>
                        <div class="d-flex people-count">
                            <span class="nowval">0</span>
                            <span class="maxval"> /5</span>
                        </div>
                    </div>
                    <div class="w-100 position-relative">
                        <div class="place-value-outside">
                            <div class="people-status d-flex align-items-center">
                                <span>人少</span>
                                <div class="w-100 d-flex align-items-center flex-column position-relative">
                                    <p class="people-rangebar">
                                        <span></span>
                                        <span></span>
                                        <span></span>
                                    </p>
                                    <p class="triangle low"></p>
                                </div>
                                <span>人多</span>
                            </div>
                            <label class="sparse" style="display:none;">1</label>
                            <label class="crowded" style="display:none;">3</label>
                        </div>
                    </div>

                </div>
            </div>
            <div class="placename-outside">
                <div class="d-flex">
                    <img src="./map.svg" alt="map" class="map-icon">
                    <img src="./hand-point.svg" alt="map" class="map-icon blink">
                </div>
                <h5 class="placename">一樓東側 女廁</h5>
            </div>
        </div>
    </div>
</div>
        <div class="d-flex flex-wrap w-100 flex-grow-1" id="suggestBlock" style="display: none; background: none 0% 0% / auto repeat scroll padding-box border-box rgb(33, 146, 152);">
            <div class="text-center text-white other-place col-12 px-5" id="SuggestedDiversion1" style="display: none; border-bottom: none;">
                <span id="firtilte">建議分流</span>
                <p>
                    <label id="firplace" name="firplace"></label>
                </p>
                <p>
                    <span id="firmins" name="firmins"></span>
                    <span>
                        <label id="firdistance" name="firdistance"></label>
                    </span>
                </p>
            </div>
            <div class="text-center text-white other-place col-12 px-5" id="SuggestedDiversion2" style="display: none;">
                <span id="sectilte">建議分流</span>
                <p>
                    <label id="secplace" name="secplace"></label>
                </p>
                <p>
                    <span id="secmins" name="secmins"></span>
                    <span>
                        <label id="secdistance" name="secdistance"></label>
                    </span>
                </p>
            </div>
        </div>
    </div>
    
    <div style="position: absolute; padding: 0px 10px; top: 0px; left: 0px; z-index: 999; display: none;" id="BackToMulti" class="blink">
        <img src="./arrow-left.svg" alt="arrow-left">
    </div>


<script>
    const peopleBlock_old = `
    <div class="man">
        <div class=" bg-white people-outside">
            <div class="value-outside">
                <div>
<svg
   viewBox="0 0 59.871094 51.097656"
   version="1.1"
   xmlns="http://www.w3.org/2000/svg"
   xmlns:svg="http://www.w3.org/2000/svg" class="man-svg">
  <path
    d="m 17.736328,0 c -3.50481,0 -5.472156,1.1260606 -6.878906,2.0566406 -3.8141502,2.52309 -5.1845233,6.400985 -4.0019533,10.2343754 1.3546701,4.39127 4.0070463,4.599623 5.5722663,7.371093 1.76042,3.1171 -0.07991,4.684968 -2.5273442,6.710938 C 6.3383106,29.321687 4.2698849,32.717839 2.4218749,37.230469 1.1156023,40.420248 0.35035545,43.79417 0,45.546875 a 53.936939,32.512138 0 0 0 4.9062499,1.771484 c 0.3140706,-1.149844 0.91611,-3.307375 1.5664063,-5.095703 1.1423,-3.14135 2.5703126,-5.855468 2.5703126,-5.855468 0,0 -1.2309291,7.676996 -0.328125,12.083984 a 53.936939,32.512138 0 0 0 2.2910162,0.521484 c 0.449405,-1.806431 1.090687,-4.018219 1.972656,-6.171875 1.91279,-4.67083 4.202104,-8.453125 8.052734,-11.640625 1.21834,-1.00854 2.08467,-1.837934 2.34961,-2.339844 0.26496,-0.501889 0.37566,-0.674116 -0.28711,-1.847656 -0.55533,-0.9833 -1.333645,-1.536587 -2.478515,-2.591797 -1.14488,-1.05521 -2.480602,-2.635448 -3.263672,-5.173828 -1.42275,-4.61194 0.391744,-9.5684541 4.808594,-12.4902341 1.10937,-0.73385 2.788624,-1.6825294 5.171874,-2.1308594 C 26.637242,3.6504175 25.731645,2.7951506 24.615235,2.0566406 23.208475,1.1260706 21.241138,0 17.736328,0 Z m 24.400391,0 c -3.5048,0 -5.474109,1.1260606 -6.880859,2.0566406 -1.09118,0.72183 -1.979509,1.5540638 -2.667969,2.4648438 2.57748,0.41533 4.371879,1.4225594 5.537109,2.1933594 4.41684,2.92177 6.231354,7.8802272 4.808594,12.4921872 -0.78307,2.53838 -2.116839,4.118618 -3.261719,5.173828 -1.14488,1.05521 -1.923185,1.608497 -2.478515,2.591797 -0.66277,1.17354 -0.55205,1.345756 -0.28711,1.847656 0.26495,0.5019 1.13128,1.329361 2.34961,2.337891 3.85064,3.1875 6.139944,6.971738 8.052734,11.642578 0.869368,2.122908 1.503006,4.299441 1.951172,6.091797 a 53.936939,32.512138 0 0 0 1.898437,-0.443359 c 0.902805,-4.406995 -0.330078,-12.082031 -0.330078,-12.082031 0,0 1.428003,2.712165 2.570313,5.853515 0.650288,1.788328 1.254289,3.947812 1.568359,5.097656 a 53.936939,32.512138 0 0 0 4.904297,-1.771484 c -0.350386,-1.752793 -1.115679,-5.126796 -2.421875,-8.316406 -1.848,-4.51263 -3.914472,-7.910725 -7.476562,-10.859375 -2.44745,-2.02597 -4.289717,-3.593838 -2.529297,-6.710938 1.56521,-2.77147 4.217605,-2.979834 5.572265,-7.371094 1.18257,-3.8333995 -0.18585,-7.7093314 -4,-10.2324214 C 47.608865,1.1260706 45.641529,0 42.136719,0 Z M 29.935547,6.328125 c -3.5048,0 -5.472156,1.1260606 -6.878906,2.0566406 -3.81415,2.5230904 -5.18257,6.4009854 -4,10.2343754 1.35467,4.39127 4.005092,4.599623 5.570312,7.371093 1.76042,3.1171 -0.07991,4.684968 -2.527343,6.710938 -3.56209,2.94864 -5.628563,6.344792 -7.476563,10.857422 -0.814335,1.98851 -1.416316,4.058764 -1.847656,5.777344 a 53.936939,32.512138 0 0 0 5.332031,0.910156 c 0.187869,-0.593243 0.378837,-1.184865 0.564453,-1.695313 1.1423,-3.14135 2.570313,-5.855469 2.570313,-5.855469 0,0 -0.622742,3.976121 -0.644531,7.84961 a 53.936939,32.512138 0 0 0 9.33789,0.552734 53.936939,32.512138 0 0 0 9.339844,-0.552734 c -0.02168,-3.873839 -0.646484,-7.84961 -0.646484,-7.84961 0,0 1.428012,2.712166 2.570312,5.853516 0.185652,0.51054 0.378505,1.10391 0.566406,1.697266 a 53.936939,32.512138 0 0 0 5.332032,-0.91211 C 46.66634,47.61575 46.064042,45.546396 45.25,43.558594 c -1.848,-4.51263 -3.914472,-7.910725 -7.476562,-10.859375 -2.44745,-2.02597 -4.289717,-3.593838 -2.529297,-6.710938 1.56521,-2.77146 4.217605,-2.979834 5.572266,-7.371093 1.182579,-3.8334 -0.187804,-7.709322 -4.001954,-10.2324224 -1.40676,-0.93057 -3.374096,-2.0566406 -6.878906,-2.0566406 z" />
</svg>

                    <div>
                        <p class="place-value-outside">
                            <label class="nowval"></label>
                            <label class="maxval"></label>
                        </p>
                    </div>
                </div>
            </div>
            <div class="placename-outside">
                <div class="d-flex">
                    <img src="/Resources/MirrorIot/img/map.svg" alt="map" class="map-icon" />
                    <img src="/Resources/MirrorIot/img/hand-point.svg" alt="map"  class="map-icon blink"/>
                </div>
                <h5 class="placename"></h5>
            </div>
        </div>
    </div>
`;

    const peopleBlock = `
    <div class="man">
        <div class=" bg-white people-outside">
            <div class="value-outside">
                <div>
                    <div class="d-flex align-items-center">
                        <div>
                            <svg
                               viewBox="0 0 59.871094 51.097656"
                               version="1.1"
                               xmlns="http://www.w3.org/2000/svg"
                               xmlns:svg="http://www.w3.org/2000/svg" class="man-svg">
                              <path
                                d="m 17.736328,0 c -3.50481,0 -5.472156,1.1260606 -6.878906,2.0566406 -3.8141502,2.52309 -5.1845233,6.400985 -4.0019533,10.2343754 1.3546701,4.39127 4.0070463,4.599623 5.5722663,7.371093 1.76042,3.1171 -0.07991,4.684968 -2.5273442,6.710938 C 6.3383106,29.321687 4.2698849,32.717839 2.4218749,37.230469 1.1156023,40.420248 0.35035545,43.79417 0,45.546875 a 53.936939,32.512138 0 0 0 4.9062499,1.771484 c 0.3140706,-1.149844 0.91611,-3.307375 1.5664063,-5.095703 1.1423,-3.14135 2.5703126,-5.855468 2.5703126,-5.855468 0,0 -1.2309291,7.676996 -0.328125,12.083984 a 53.936939,32.512138 0 0 0 2.2910162,0.521484 c 0.449405,-1.806431 1.090687,-4.018219 1.972656,-6.171875 1.91279,-4.67083 4.202104,-8.453125 8.052734,-11.640625 1.21834,-1.00854 2.08467,-1.837934 2.34961,-2.339844 0.26496,-0.501889 0.37566,-0.674116 -0.28711,-1.847656 -0.55533,-0.9833 -1.333645,-1.536587 -2.478515,-2.591797 -1.14488,-1.05521 -2.480602,-2.635448 -3.263672,-5.173828 -1.42275,-4.61194 0.391744,-9.5684541 4.808594,-12.4902341 1.10937,-0.73385 2.788624,-1.6825294 5.171874,-2.1308594 C 26.637242,3.6504175 25.731645,2.7951506 24.615235,2.0566406 23.208475,1.1260706 21.241138,0 17.736328,0 Z m 24.400391,0 c -3.5048,0 -5.474109,1.1260606 -6.880859,2.0566406 -1.09118,0.72183 -1.979509,1.5540638 -2.667969,2.4648438 2.57748,0.41533 4.371879,1.4225594 5.537109,2.1933594 4.41684,2.92177 6.231354,7.8802272 4.808594,12.4921872 -0.78307,2.53838 -2.116839,4.118618 -3.261719,5.173828 -1.14488,1.05521 -1.923185,1.608497 -2.478515,2.591797 -0.66277,1.17354 -0.55205,1.345756 -0.28711,1.847656 0.26495,0.5019 1.13128,1.329361 2.34961,2.337891 3.85064,3.1875 6.139944,6.971738 8.052734,11.642578 0.869368,2.122908 1.503006,4.299441 1.951172,6.091797 a 53.936939,32.512138 0 0 0 1.898437,-0.443359 c 0.902805,-4.406995 -0.330078,-12.082031 -0.330078,-12.082031 0,0 1.428003,2.712165 2.570313,5.853515 0.650288,1.788328 1.254289,3.947812 1.568359,5.097656 a 53.936939,32.512138 0 0 0 4.904297,-1.771484 c -0.350386,-1.752793 -1.115679,-5.126796 -2.421875,-8.316406 -1.848,-4.51263 -3.914472,-7.910725 -7.476562,-10.859375 -2.44745,-2.02597 -4.289717,-3.593838 -2.529297,-6.710938 1.56521,-2.77147 4.217605,-2.979834 5.572265,-7.371094 1.18257,-3.8333995 -0.18585,-7.7093314 -4,-10.2324214 C 47.608865,1.1260706 45.641529,0 42.136719,0 Z M 29.935547,6.328125 c -3.5048,0 -5.472156,1.1260606 -6.878906,2.0566406 -3.81415,2.5230904 -5.18257,6.4009854 -4,10.2343754 1.35467,4.39127 4.005092,4.599623 5.570312,7.371093 1.76042,3.1171 -0.07991,4.684968 -2.527343,6.710938 -3.56209,2.94864 -5.628563,6.344792 -7.476563,10.857422 -0.814335,1.98851 -1.416316,4.058764 -1.847656,5.777344 a 53.936939,32.512138 0 0 0 5.332031,0.910156 c 0.187869,-0.593243 0.378837,-1.184865 0.564453,-1.695313 1.1423,-3.14135 2.570313,-5.855469 2.570313,-5.855469 0,0 -0.622742,3.976121 -0.644531,7.84961 a 53.936939,32.512138 0 0 0 9.33789,0.552734 53.936939,32.512138 0 0 0 9.339844,-0.552734 c -0.02168,-3.873839 -0.646484,-7.84961 -0.646484,-7.84961 0,0 1.428012,2.712166 2.570312,5.853516 0.185652,0.51054 0.378505,1.10391 0.566406,1.697266 a 53.936939,32.512138 0 0 0 5.332032,-0.91211 C 46.66634,47.61575 46.064042,45.546396 45.25,43.558594 c -1.848,-4.51263 -3.914472,-7.910725 -7.476562,-10.859375 -2.44745,-2.02597 -4.289717,-3.593838 -2.529297,-6.710938 1.56521,-2.77146 4.217605,-2.979834 5.572266,-7.371093 1.182579,-3.8334 -0.187804,-7.709322 -4.001954,-10.2324224 -1.40676,-0.93057 -3.374096,-2.0566406 -6.878906,-2.0566406 z" />
                            </svg>
                        </div>
                        <div class="d-flex people-count">
                            <span class="nowval"></span>
                            <span class="maxval"></span>
                        </div>
                    </div>
                    <div class="w-100 position-relative">
                        <div class="place-value-outside">
                            <div class="people-status d-flex align-items-center">
                                <span>人少</span>
                                <div class="w-100 d-flex align-items-center flex-column position-relative">
                                    <p class="people-rangebar">
                                        <span></span>
                                        <span></span>
                                        <span></span>
                                    </p>
                                    <p class="triangle"></p>
                                </div>
                                <span>人多</span>
                            </div>
                            <label class="sparse" style="display:none;"></label>
                            <label class="crowded" style="display:none;"></label>
                        </div>
                    </div>

                </div>
            </div>
            <div class="placename-outside">
                <div class="d-flex">
                    <img src="/Resources/MirrorIot/img/map.svg" alt="map" class="map-icon" />
                    <img src="/Resources/MirrorIot/img/hand-point.svg" alt="map"  class="map-icon blink"/>
                </div>
                <h5 class="placename"></h5>
            </div>
        </div>
    </div>
`;

    var _basePath = '/BsPages/MirrorPages/peopleiframe.aspx'; //執行路徑
    var timeOutdivert;
    var timeOutPeople;
    $(document).ready()
    {
        query();
        divert();
        //setInterval(divert, 10000);//10秒刷新推薦
        //setInterval(nowvalQuery, 1000);//如以該方式執行的話，要把timeout的方式移除
        nowvalQuery();
    }
    function divert() {
        ////初始化UI
        $(".man").show();
        //調整建議分流顏色
        $("#suggestBlock").css("background", $(".placename-outside").css("background")).hide();
        if ($(".man").length > 1) {
            $("#PeopleDataPlace").removeClass("ver-blcok-num1").addClass("ver-blcok-num" + $(".man").length);
            $(".map-icon.blink").show();
        }
        $("#BackToMulti").hide();

        let CUST_TYPE = localStorage.getItem("CUST_TYPE");
        let Location = localStorage.getItem("Location");
        //ajaxSend('QueryAjax', 'CUST_TYPE=' + CUST_TYPE + '&Location=' + Location, queryAfter);
        ajaxSend('QueryRelationAjax', 'CUST_TYPE=' + CUST_TYPE + '&Location=' + Location, QueryRelationAfter);

    }
    function query() {
        let CUST_TYPE = localStorage.getItem("CUST_TYPE");
        let Location = localStorage.getItem("Location");
        ajaxSend('QueryAjax', 'CUST_TYPE=' + CUST_TYPE + '&Location=' + Location, queryAfter);
        //ajaxSend('QueryRelationAjax', 'CUST_TYPE=' + CUST_TYPE + '&Location=' + Location, QueryRelationAfter);

    }
    function nowvalQuery() {
        let CUST_TYPE = localStorage.getItem("CUST_TYPE");
        let Location = localStorage.getItem("Location");
        ajaxSend('QueryNOWAjax', 'CUST_TYPE=' + CUST_TYPE + '&Location=' + Location, nowvalQueryAfter);
    }
    function nowvalQueryAfter(obj) {
        if (obj["returnStatus"] == "false") {
            showMsg(obj["errorMessage"]);
            return false;
        }
        let data = JSON.parse(obj['data']);
        for (let i = 0; i < data.length; i++) {
            let singleData = data[i];
            if (singleData['seq'] != undefined) {
                let seq = singleData['seq'];
                let valueOutside = $(".value-outside[data-seq='" + seq + "']");
                $(valueOutside.get(0).querySelector(".nowval")).text(singleData['nowval']);
                let triangle = valueOutside.get(0).querySelector(".triangle");
                showPeopleRange($(triangle), {
                    "nowval": singleData['nowval'],
                    "sparse": $(valueOutside.get(0).querySelector(".sparse")).text(),
                    "crowded": $(valueOutside.get(0).querySelector(".crowded")).text()
                });
            }
        }
        if (timeOutPeople != undefined) {
            clearTimeout(timeOutPeople);
        }
        timeOutPeople = setTimeout(nowvalQuery, 1000);
    }
    function queryAfter(obj) {
        if (obj["returnStatus"] == "false") {
            showMsg(obj["errorMessage"]);
            return false;
        }
        let data = JSON.parse(obj['data']);
        //if (data == null || data == "" || data == []) {
        //    $("body").hide();
        //    sessionStorage.setItem("hasIframeContent", 0);
        //}
        //else {
        //    sessionStorage.setItem("hasIframeContent", 1);
        //}
        let PeopleDataPlaceNodeNum = $("#PeopleDataPlace").children().length;
        let refreshedParentTimes = sessionStorage.getItem("refreshedParentTimes");
        if (refreshedParentTimes == 0) {
            parent.location.reload();
            sessionStorage.setItem("refreshedParentTimes", 1);
        }
        //document.querySelector(':root').style.setProperty('--num', data.length);

        //if (testJsonData.length == 1 && PeopleDataPlaceNodeNum < 1) {
        //    $("#PeopleDataPlace").append(peopleBlock);
        //    $("#PeopleDataPlace .man").append(suggestBlock);
        //    $("#PeopleDataPlace").addClass("ver-blcok-num1");
        //    //$("#PeopleDataPlace .man:first-child .people-outside").append(gotoOtherUrlBtn);
        //}
        //if (testJsonData.length == 1) {
        //    data = testJsonData[0];
        //    if (data['placename'] != undefined)
        //        $('.placename').text(data['placename']);
        //    if (data['nowval'] != undefined)
        //        $('.nowval').text(data['nowval']);
        //    if (data['maxval'] != undefined)
        //        $('.maxval').text(data['maxval']);

        //}
        //else {
        $("#PeopleDataPlace").addClass("ver-blcok-num" + data.length);
        for (let i = 0; i < data.length; i++) {
            let singleData = data[i];
            if (PeopleDataPlaceNodeNum < data.length) {
                $("#PeopleDataPlace").append(peopleBlock);
            }
            if (singleData['seq'] != undefined) {
                $($('.value-outside')[i]).attr("data-seq", singleData['seq']);
            }
            if (singleData['placename'] != undefined)
                $($('.placename')[i]).text(singleData['placename']);
            if (singleData['nowval'] != undefined)
                $($('.nowval')[i]).text(singleData['nowval']);
            if (singleData['maxval'] != undefined)
                $($('.maxval')[i]).text(singleData['maxval']);

            if (singleData['sparse'] != undefined)
                $($('.sparse')[i]).text(singleData['sparse']);
            if (singleData['crowded'] != undefined)
                $($('.crowded')[i]).text(singleData['crowded']);
            showPeopleRange($($('.value-outside .triangle')[i]), {
                "nowval": singleData['nowval'],
                "sparse": singleData['sparse'],
                "crowded": singleData['crowded']
            });
        }
        if (data.length == 1 && PeopleDataPlaceNodeNum < 1) {
            //$("#PeopleDataPlace .man").append(suggestBlock);
            $(".map-icon.blink").hide();
        }
        else {
            $(".map-icon.blink").show();
            $("#suggestBlock").hide();
        }


        //$('#nowval').text(data['nowval']);
        //$('#maxval').text(data['maxval']);
        //if (data['firplace'] != undefined && data['firplace'] != null && data['firplace'] != "") {
        //    $("#firtilte").show();
        //    $('#firplace').text(data['firplace']);
        //    $('#firmins').text(data['firmins']);
        //    $('#firdistance').text(data['firdistance']);
        //    $(".other-place:nth-child(1)").css("border-bottom", "20px solid rgba(255, 255, 255, 0.5)");
        //    if (data['secplace'] != undefined && data['secplace'] != null && data['secplace'] != "") {
        //        $("#sectilte").show();
        //        $('#secplace').text(data['secplace']);
        //        $('#secmins').text(data['secmins']);
        //        $('#secdistance').text(data['secdistance']);
        //    }
        //    else {
        //        $("#SuggestedDiversion2").hide();
        //        $(".other-place:nth-child(1)").css("border-bottom", "none");
        //    }
        //}
        //else {
        //    $("#firtilte").hide();
        //    $(".other-place:nth-child(1)").css("border-bottom", "none");
        //    $("#SuggestedDiversion2").hide();
        //}
    }

    function QueryRelationAfter(obj) {
        if (obj["returnStatus"] == "false") {
            showMsg(obj["errorMessage"]);
            return false;
        }
        if ($("#suggestBlock").get(0) == undefined)
            return false;
        $("#SuggestedDiversion1").hide();
        $("#SuggestedDiversion2").hide();
        $(".other-place:nth-child(1)").css("border-bottom", "none");
        let data = null;
        if (obj != null && obj != "") {
            data = JSON.parse(obj['data']);
        }
        else return;
        $(".map-icon.blink").hide();
        //$("#PeopleDataPlace").addClass("ver-blcok-num1");
        if (data['firplace'] != undefined && data['firplace'] != null && data['firplace'] != "") {
            $("#firtilte").show();
            $('#firplace').text(data['firplace']);
            $('#firmins').text(data['firmins']);
            $('#firdistance').text(data['firdistance']);
            $("#SuggestedDiversion1").show();
            if (data['secplace'] != undefined && data['secplace'] != null && data['secplace'] != "") {
                $("#sectilte").show();
                $('#secplace').text(data['secplace']);
                $('#secmins').text(data['secmins']);
                $('#secdistance').text(data['secdistance']);
                $("#SuggestedDiversion2").show();
                $(".other-place:nth-child(1)").css("border-bottom", ".9em solid rgba(255, 255, 255, 0.5)");
            }
        }

        if (timeOutdivert != undefined)
            clearTimeout(timeOutdivert);
        timeOutdivert = setTimeout(divert,  300000);
    }

    //$("#GOTO_AIOT").on("touchstart mousedown", () => {
    //    last = new Date();
    //})
    //$("#GOTO_AIOT").on("touchend mouseup", () => {
    //    now = new Date();
    //    if (now - last > 5 * 1000) {
    //        window.parent.location.assign("http://intelligentiot.azurewebsites.net/BsPages/Common/SysLogin.aspx");
    //    }
    //})
    //$("#GOTO_LOCATION_SETTING").on("touchstart mousedown", () => {
    //    last = new Date();
    //})
    //$("#GOTO_LOCATION_SETTING").on("touchend mouseup", () => {
    //    now = new Date();
    //    if (now - last > 5 * 1000) {
    //        window.parent.location.assign("/BsPages/MirrorPages/LocationSetting.aspx");
    //    }
    //})

    $(".map-icon").click((e) => {
        if ($(".map-icon.blink").css("display") == "none") return
        let el = $(e.currentTarget).parent().parent().parent().parent();
        let els = $(el).parent().children();
        let index = $(els).index(el)
        $(".man:not(:nth-child(" + (index + 1) + "))").hide();
        $("#PeopleDataPlace").removeClass("ver-blcok-num" + $(".man").length).addClass("ver-blcok-num1");
        $("#BackToMulti").show();
        //調整建議分流顏色
        let showColor = $($(".placename-outside")[index]).css("background");
        $("#suggestBlock").css("background", showColor).show();

        let CUST_TYPE = localStorage.getItem("CUST_TYPE");
        let Location = $($(".value-outside")[index]).attr("data-seq");
        ajaxSend('QueryRelationAjax', 'CUST_TYPE=' + CUST_TYPE + '&Location=' + Location, QueryRelationAfter);
    })

    $("#BackToMulti").click(() => {
        divert();
    })

    function showPeopleRange(jqElement, objDatas) {
        let nowval = Number(objDatas.nowval);
        let sparse = Number(objDatas.sparse);
        let crowded = Number(objDatas.crowded);
        if (nowval <= sparse) {
            removeClassByList(jqElement,["normal", "high"]);
            jqElement.addClass("low");
        }
        else if (nowval > sparse && nowval <= crowded) {
            removeClassByList(jqElement,["low", "high"]);
            jqElement.addClass("normal");
        }
        else {
            removeClassByList(jqElement,["normal", "low"]);
            jqElement.addClass("high");
        }
    }

    function removeClassByList(jqEl, classArr) {
        $(classArr).each((i, className) => {
            if (jqEl.hasClass(className)) jqEl.removeClass(className);
        })
    }
</script>
<svg viewBox="0 0 862.9 862.9" fill="#fff" id="AlertIcon" style="position: fixed; width: 45px; height: 45px; right: 0px; top: 0px; opacity: 0.5; padding: 8px; margin: 5px; z-index: 500000000; display: none; background: rgb(33, 146, 152); border-radius: 10px;"><path d="M561.7,401c-15.801-10.3-32.601-19.2-50.2-26.6c-39.9-16.9-82.3-25.5-126-25.5c-44.601,0-87.9,8.9-128.6,26.6c-39.3,17-74.3,41.3-104.1,72.2L253.5,545c34.899-36.1,81.8-56,132-56c49,0,95.1,19.1,129.8,53.8l25.4-25.399L493,469.7L561.7,401z"></path><path d="M385.6,267.1c107.601,0,208.9,41.7,285.3,117.4l98.5-99.5c-50-49.5-108.1-88.4-172.699-115.6c-66.9-28.1-138-42.4-211.101-42.4c-73.6,0-145,14.4-212.3,42.9c-65,27.5-123.3,66.8-173.3,116.9l99,99C175.5,309.299,277.3,267.1,385.6,267.1z"></path><circle cx="385.6" cy="656.1" r="79.8"></circle><polygon points="616.8,402.5 549.7,469.599 639.2,559.099 549.7,648.599 616.8,715.7 706.3,626.2 795.8,715.7 862.899,648.599 773.399,559.099 862.899,469.599 795.8,402.5 706.3,492"></polygon></svg></body></html>